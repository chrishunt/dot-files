#!/bin/sh
# What have we done this week?

LAST_WEEK=$(date -v-7d +%m/%d)

STATS=$(
  git log --since=1.week --oneline |
  tail -n 1                        |
  awk '{ print $1 }'               |
  xargs git diff --shortstat
)

FEATURES=$(
  git log --since=1.week --oneline |
  egrep "Merge (pull|branch) "
)

FEATURES_COUNT=$(
  echo "$FEATURES" |
  sed '/^\s*$/d'   |
  wc -l            |
  awk '{ print $1 }'
)

echo "Stats ($LAST_WEEK - Today)"
echo "---------------------"
echo "$STATS"
echo
echo "Features ($FEATURES_COUNT)"
echo "-------------"
echo "$FEATURES"
