#!/bin/sh

# Compares current git branch with master on GitHub.
# Used for making pull requests.

current_branch=$(git branch | grep '* ' | awk '{print $2}')
compare_to=${1:-"master"}
repo_path=$(
  git config -l | \
  grep 'remote.origin.url' | \
  egrep -o '[^\/:]+\/[^\/]+$' | \
  sed -e 's/\(.*\).git$/\1/'
)
user=$(echo $repo_path | awk 'BEGIN { FS="/" } ; { print $1 }')
repo=$(echo $repo_path | awk 'BEGIN { FS="/" } ; { print $2 }')

if [ -z "$GITHUB_HOST" ]; then
  GITHUB_HOST="github.com"
fi

explorer.exe "https://$GITHUB_HOST/$user/$repo/compare/$current_branch"
