#!/bin/sh

# Compares current git branch with master on GitHub.
# Used for making pull requests.

current_branch=$(git branch | grep '* ' | awk '{print $2}')
compare_to=${1:-"master"}

repo=$(
  git config -l | \
  grep 'remote.origin.url'
)

repo_path=$(
  echo $repo | \
  egrep -o '[^\/:]+\/[^\/]+$' | \
  sed -e 's/\(.*\).git$/\1/'
)

host=$(
  echo $repo | \
  egrep -o '=.*:' | \
  sed -e 's/git@//' | \
  sed -e 's/=\(.*\):/\1/'
)

user=$(echo $repo_path | awk 'BEGIN { FS="/" } ; { print $1 }')
repo=$(echo $repo_path | awk 'BEGIN { FS="/" } ; { print $2 }')

echo "https://$host/$user/$repo/compare/$current_branch"
